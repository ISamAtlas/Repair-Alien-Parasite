[gd_scene format=3 uid="uid://dlmbyfn0jxty3"]

[ext_resource type="Script" uid="uid://ck8x2kfiejr1f" path="res://scripts/characters/player.gd" id="1_rp718"]
[ext_resource type="Texture2D" uid="uid://dfc0mqaabrlt4" path="res://icon.svg" id="2_yewv4"]
[ext_resource type="Script" uid="uid://bqiis0cj721ms" path="res://scripts/characters/procedural_legs.gd" id="3_76oj4"]
[ext_resource type="Texture2D" uid="uid://v6ks0cjec4fl" path="res://assets/characters/leg.png" id="3_dyp2m"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_76oj4"]
size = Vector2(64, 18)

[sub_resource type="SkeletonModification2DCCDIK" id="SkeletonModification2DCCDIK_76oj4"]
target_nodepath = NodePath("../../IK targets/LeftLeg Target")
tip_nodepath = NodePath("thigh1/thigh2/shin/foot")
ccdik_data_chain_length = 3
joint_data/0/bone_index = 0
joint_data/0/bone2d_node = NodePath("thigh1")
joint_data/0/rotate_from_joint = false
joint_data/0/enable_constraint = true
joint_data/0/constraint_angle_min = 100.30099
joint_data/0/constraint_angle_max = -186.45898
joint_data/0/constraint_angle_invert = false
joint_data/0/constraint_in_localspace = true
joint_data/0/editor_draw_gizmo = true
joint_data/1/bone_index = 1
joint_data/1/bone2d_node = NodePath("thigh1/thigh2")
joint_data/1/rotate_from_joint = false
joint_data/1/enable_constraint = true
joint_data/1/constraint_angle_min = 26.718996
joint_data/1/constraint_angle_max = 303.616
joint_data/1/constraint_angle_invert = true
joint_data/1/constraint_in_localspace = true
joint_data/1/editor_draw_gizmo = true
joint_data/2/bone_index = 2
joint_data/2/bone2d_node = NodePath("thigh1/thigh2/shin")
joint_data/2/rotate_from_joint = false
joint_data/2/enable_constraint = true
joint_data/2/constraint_angle_min = -318.91492
joint_data/2/constraint_angle_max = -93.052
joint_data/2/constraint_angle_invert = true
joint_data/2/constraint_in_localspace = true
joint_data/2/editor_draw_gizmo = true

[sub_resource type="SkeletonModification2DCCDIK" id="SkeletonModification2DCCDIK_dyp2m"]
target_nodepath = NodePath("../../IK targets/RightLeg Target")
tip_nodepath = NodePath("thigh2/thigh2/shin/foot")
ccdik_data_chain_length = 3
joint_data/0/bone_index = 4
joint_data/0/bone2d_node = NodePath("thigh2")
joint_data/0/rotate_from_joint = false
joint_data/0/enable_constraint = true
joint_data/0/constraint_angle_min = -100.30099
joint_data/0/constraint_angle_max = 186.45898
joint_data/0/constraint_angle_invert = false
joint_data/0/constraint_in_localspace = true
joint_data/0/editor_draw_gizmo = true
joint_data/1/bone_index = 5
joint_data/1/bone2d_node = NodePath("thigh2/thigh2")
joint_data/1/rotate_from_joint = false
joint_data/1/enable_constraint = true
joint_data/1/constraint_angle_min = -26.718996
joint_data/1/constraint_angle_max = -303.616
joint_data/1/constraint_angle_invert = true
joint_data/1/constraint_in_localspace = true
joint_data/1/editor_draw_gizmo = true
joint_data/2/bone_index = 6
joint_data/2/bone2d_node = NodePath("thigh2/thigh2/shin")
joint_data/2/rotate_from_joint = false
joint_data/2/enable_constraint = true
joint_data/2/constraint_angle_min = 318.91492
joint_data/2/constraint_angle_max = 93.052
joint_data/2/constraint_angle_invert = true
joint_data/2/constraint_in_localspace = true
joint_data/2/editor_draw_gizmo = true

[sub_resource type="SkeletonModification2DCCDIK" id="SkeletonModification2DCCDIK_atpat"]
target_nodepath = NodePath("../../IK targets/CenterKnee Target")
tip_nodepath = NodePath("knees1/shin/foot")
ccdik_data_chain_length = 4
joint_data/0/bone_index = 8
joint_data/0/bone2d_node = NodePath("knees1")
joint_data/0/rotate_from_joint = false
joint_data/0/enable_constraint = true
joint_data/0/constraint_angle_min = 4.9999995
joint_data/0/constraint_angle_max = -4.9999995
joint_data/0/constraint_angle_invert = true
joint_data/0/constraint_in_localspace = true
joint_data/0/editor_draw_gizmo = true
joint_data/1/bone_index = 9
joint_data/1/bone2d_node = NodePath("knees1/shin")
joint_data/1/rotate_from_joint = false
joint_data/1/enable_constraint = true
joint_data/1/constraint_angle_min = 19.999998
joint_data/1/constraint_angle_max = -19.999998
joint_data/1/constraint_angle_invert = true
joint_data/1/constraint_in_localspace = true
joint_data/1/editor_draw_gizmo = true
joint_data/2/bone_index = 10
joint_data/2/bone2d_node = NodePath("knees1/shin/foot")
joint_data/2/rotate_from_joint = true
joint_data/2/enable_constraint = true
joint_data/2/constraint_angle_min = -60.0
joint_data/2/constraint_angle_max = 60.0
joint_data/2/constraint_angle_invert = true
joint_data/2/constraint_in_localspace = true
joint_data/2/editor_draw_gizmo = true
joint_data/3/bone_index = 7
joint_data/3/bone2d_node = NodePath("thigh2/thigh2/shin/foot")
joint_data/3/rotate_from_joint = true
joint_data/3/enable_constraint = true
joint_data/3/constraint_angle_min = 9.999999
joint_data/3/constraint_angle_max = -9.999999
joint_data/3/constraint_angle_invert = true
joint_data/3/constraint_in_localspace = true
joint_data/3/editor_draw_gizmo = true

[sub_resource type="SkeletonModificationStack2D" id="SkeletonModificationStack2D_dyp2m"]
enabled = true
modification_count = 3
modifications/0 = SubResource("SkeletonModification2DCCDIK_76oj4")
modifications/1 = SubResource("SkeletonModification2DCCDIK_dyp2m")
modifications/2 = SubResource("SkeletonModification2DCCDIK_atpat")

[node name="Player" type="CharacterBody2D" unique_id=623290912]
collision_mask = 2
script = ExtResource("1_rp718")

[node name="Sprite2D" type="Sprite2D" parent="." unique_id=102617290]
position = Vector2(0, -64)
scale = Vector2(0.5, 0.5)
texture = ExtResource("2_yewv4")
offset = Vector2(0, 62)

[node name="CollisionShape2D" type="CollisionShape2D" parent="." unique_id=247044228]
position = Vector2(1, -4)
shape = SubResource("RectangleShape2D_76oj4")

[node name="Camera2D" type="Camera2D" parent="." unique_id=905640174]
position = Vector2(0, -39)
zoom = Vector2(1.75, 1.75)

[node name="legs" type="Node2D" parent="." unique_id=1923044990]
position = Vector2(0, -93)

[node name="CharacterContainer" type="Node2D" parent="legs" unique_id=231425896]

[node name="Bones" type="Node2D" parent="legs/CharacterContainer" unique_id=1589187651]
position = Vector2(135, 241)

[node name="Skeleton2D" type="Skeleton2D" parent="legs/CharacterContainer/Bones" unique_id=803245349]
position = Vector2(-11, -67)
scale = Vector2(2, 2)
modification_stack = SubResource("SkeletonModificationStack2D_dyp2m")

[node name="thigh1" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D" unique_id=1475335428]
position = Vector2(-73.50001, -52.999996)
rotation = 1.7505826
scale = Vector2(0.9999972, 0.9999972)
rest = Transform2D(-0.3588385, 0.9333969, -0.9333969, -0.3588385, -74.5, -47.499996)
auto_calculate_length_and_angle = false
length = 13.0
bone_angle = 89.99998
metadata/_local_pose_override_enabled_ = true

[node name="thigh2" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1" unique_id=172111068]
position = Vector2(4.2915344e-06, 13.000006)
rotation = -0.6951955
scale = Vector2(1.0000005, 1.0000005)
rest = Transform2D(0.76792884, -0.6405359, 0.6405359, 0.76792884, 4.2915344e-06, 13.000006)
auto_calculate_length_and_angle = false
length = 8.501053
bone_angle = 90.003174
metadata/_local_pose_override_enabled_ = true

[node name="shin" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1/thigh2" unique_id=1384138453]
position = Vector2(3.8146973e-06, 8.500013)
rotation = -0.73495847
scale = Vector2(0.99999994, 0.99999994)
rest = Transform2D(0.74185854, -0.6705563, 0.6705563, 0.74185854, 3.8146973e-06, 8.500013)
auto_calculate_length_and_angle = false
length = 11.50552
bone_angle = 91.29715
metadata/_local_pose_override_enabled_ = true

[node name="foot" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1/thigh2/shin" unique_id=781262935]
position = Vector2(-0.26046276, 11.502569)
rotation = -0.27139512
scale = Vector2(0.9999999, 0.9999999)
rest = Transform2D(0.96339774, -0.26807573, 0.26807573, 0.96339774, -0.26046276, 11.502569)
auto_calculate_length_and_angle = false
length = 5.0
bone_angle = 90.0

[node name="foot" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1/thigh2/shin/foot" unique_id=1162645321]
scale = Vector2(0.99999994, 0.99999994)
texture = ExtResource("3_dyp2m")
offset = Vector2(0.5547104, 3.997364)
vframes = 5
frame = 4

[node name="shin" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1/thigh2/shin" unique_id=1388411943]
texture = ExtResource("3_dyp2m")
offset = Vector2(0.3489151, 5.4986725)
vframes = 5
frame = 3

[node name="thigh2" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1/thigh2" unique_id=761248481]
texture = ExtResource("3_dyp2m")
offset = Vector2(0.3489151, 3.4986725)
vframes = 5
frame = 2

[node name="thigh1" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh1" unique_id=2099588042]
position = Vector2(0.21085727, 0.11099434)
texture = ExtResource("3_dyp2m")
offset = Vector2(-0.5554352, 6.844673)
vframes = 5
frame = 1

[node name="LeftLegBoundingBox" type="Node2D" parent="legs/CharacterContainer/Bones/Skeleton2D" unique_id=1323111793 node_paths=PackedStringArray("target")]
position = Vector2(-89, -38.5)
script = ExtResource("3_76oj4")
target = NodePath("../../../IK targets/LeftLeg Target")
walk_index = 1

[node name="thigh2" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D" unique_id=2061709091]
position = Vector2(-49.5, -50.999996)
rotation = -1.7505826
scale = Vector2(0.9999945, 0.9999945)
rest = Transform2D(-0.17881829, -0.9838765, 0.9838765, -0.17881829, -49, -47.5)
auto_calculate_length_and_angle = false
length = 13.0
bone_angle = 89.99995
metadata/_local_pose_override_enabled_ = true

[node name="thigh2" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2" unique_id=589805563]
position = Vector2(1.1087713, 10.7132225)
rotation = -0.0018542409
scale = Vector2(0.99993503, 0.99993503)
rest = Transform2D(0.9999324, -0.0018541217, 0.0018541217, 0.9999324, 1.1087713, 10.7132225)
auto_calculate_length_and_angle = false
length = 8.501053
bone_angle = 90.00315
metadata/_local_pose_override_enabled_ = true

[node name="shin" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2/thigh2" unique_id=1840123377]
position = Vector2(-0.4447112, 11.74544)
rotation = 0.015204214
scale = Vector2(0.9999967, 0.9999967)
rest = Transform2D(0.9998811, 0.015203342, -0.015203342, 0.9998811, -0.44471407, 11.745451)
auto_calculate_length_and_angle = false
length = 11.50552
bone_angle = 91.29715
metadata/_local_pose_override_enabled_ = true

[node name="foot" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2/thigh2/shin" unique_id=554567690]
position = Vector2(-0.26046276, 11.502569)
scale = Vector2(0.99999994, 0.99999994)
rest = Transform2D(0.99999994, 0, 0, 0.99999994, -0.26046276, 11.502569)
auto_calculate_length_and_angle = false
length = 5.0
bone_angle = 90.0
metadata/_local_pose_override_enabled_ = true

[node name="foot" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2/thigh2/shin/foot" unique_id=1546498584]
position = Vector2(0.2604638, -0.0025548935)
scale = Vector2(0.99999994, 0.99999994)
texture = ExtResource("3_dyp2m")
offset = Vector2(0, 6.500003)
flip_h = true
vframes = 5
frame = 4

[node name="shin" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2/thigh2/shin" unique_id=223751021]
position = Vector2(0.46967614, -2.2300854)
rotation = 3.1415927
texture = ExtResource("3_dyp2m")
offset = Vector2(0.15545702, -8.198347)
flip_v = true
vframes = 5
frame = 3

[node name="thigh2" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2/thigh2" unique_id=664199738]
position = Vector2(0, 5.722046e-06)
texture = ExtResource("3_dyp2m")
offset = Vector2(0, 5.000002)
flip_h = true
flip_v = true
vframes = 5
frame = 2

[node name="thigh1" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/thigh2" unique_id=775673635]
position = Vector2(1.0732974, -0.31312367)
rotation = 3.1415927
texture = ExtResource("3_dyp2m")
offset = Vector2(-0.0015869141, -7.5982094)
flip_v = true
vframes = 5
frame = 1

[node name="RightLegBoundingBox" type="Node2D" parent="legs/CharacterContainer/Bones/Skeleton2D" unique_id=2000344632 node_paths=PackedStringArray("target")]
position = Vector2(-28.5, -39)
script = ExtResource("3_76oj4")
target = NodePath("../../../IK targets/RightLeg Target")
walk_index = 1

[node name="knees1" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D" unique_id=2084981136]
position = Vector2(-61.5, -57)
rotation = 0.013334626
scale = Vector2(0.99997675, 0.99997675)
rest = Transform2D(0.9999981, 0.0019186834, -0.0019186834, 0.9999981, -62, -54.5)
auto_calculate_length_and_angle = false
length = 10.000001
bone_angle = 90.0
metadata/_local_pose_override_enabled_ = true

[node name="Sprite2D" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/knees1" unique_id=1099483025]
position = Vector2(0, -1.5)
texture = ExtResource("3_dyp2m")
offset = Vector2(0, 2)
vframes = 5

[node name="shin" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/knees1" unique_id=1957075576]
position = Vector2(2.0802021e-05, 10.000307)
rotation = 1.7453293
scale = Vector2(1.0000412, 1.0000412)
rest = Transform2D(1, 0, 0, 1, 0, 10)
auto_calculate_length_and_angle = false
length = 11.000873
bone_angle = 89.35109
metadata/_local_pose_override_enabled_ = true

[node name="Sprite2D" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/knees1/shin" unique_id=298016008]
position = Vector2(8.473981e-06, 3.4996731)
texture = ExtResource("3_dyp2m")
vframes = 5
frame = 3

[node name="foot" type="Bone2D" parent="legs/CharacterContainer/Bones/Skeleton2D/knees1/shin" unique_id=129062255]
position = Vector2(0.12456554, 10.999352)
rest = Transform2D(1, 0, 0, 1, 0, 14)
auto_calculate_length_and_angle = false
length = 5.0
bone_angle = 90.0
metadata/_local_pose_override_enabled_ = true

[node name="Sprite2D" type="Sprite2D" parent="legs/CharacterContainer/Bones/Skeleton2D/knees1/shin/foot" unique_id=306572661]
texture = ExtResource("3_dyp2m")
offset = Vector2(0, 4)
vframes = 5
frame = 4

[node name="CenterKneeBoundary" type="Node2D" parent="legs/CharacterContainer/Bones/Skeleton2D" unique_id=207707972 node_paths=PackedStringArray("target")]
position = Vector2(-62, -26.5)
script = ExtResource("3_76oj4")
target = NodePath("../../../IK targets/CenterKnee Target")
range = 125
walk_index = -1

[node name="IK targets" type="Node2D" parent="legs/CharacterContainer" unique_id=558953320]

[node name="LeftLeg Target" type="Marker2D" parent="legs/CharacterContainer/IK targets" unique_id=1587906840]
position = Vector2(-77, 95)

[node name="RightLeg Target" type="Marker2D" parent="legs/CharacterContainer/IK targets" unique_id=410816149]
position = Vector2(192, 46)

[node name="CenterKnee Target" type="Marker2D" parent="legs/CharacterContainer/IK targets" unique_id=1088320149]
position = Vector2(0, 135)

[node name="walk_cycle" type="Timer" parent="legs" unique_id=1793924084]
wait_time = 0.1
autostart = true

[connection signal="timeout" from="legs/walk_cycle" to="." method="_on_walk_cycle_timeout"]
